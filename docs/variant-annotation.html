<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Week 4 Variant Annotation | Diagnostic Genome Analysis</title>
  <meta name="description" content="Week 4 Variant Annotation | Diagnostic Genome Analysis" />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="Week 4 Variant Annotation | Diagnostic Genome Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="https://github.com/mkempenaar/diagnostic-genome-analysis" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Week 4 Variant Annotation | Diagnostic Genome Analysis" />
  
  
  

<meta name="author" content="Marcel Kempenaar" />


<meta name="date" content="2024-03-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="analysis-of-variants.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#usage"><i class="fa fa-check"></i>Usage</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro-ngs-and-genetics-project.html"><a href="intro-ngs-and-genetics-project.html"><i class="fa fa-check"></i><b>1</b> Intro <em>NGS and Genetics</em> Project</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro-ngs-and-genetics-project.html"><a href="intro-ngs-and-genetics-project.html#cardiomyopathy"><i class="fa fa-check"></i><b>1.1</b> Cardiomyopathy</a></li>
<li class="chapter" data-level="1.2" data-path="intro-ngs-and-genetics-project.html"><a href="intro-ngs-and-genetics-project.html#medulloblastoma"><i class="fa fa-check"></i><b>1.2</b> Medulloblastoma</a></li>
<li class="chapter" data-level="1.3" data-path="intro-ngs-and-genetics-project.html"><a href="intro-ngs-and-genetics-project.html#tools"><i class="fa fa-check"></i><b>1.3</b> Tools</a></li>
<li class="chapter" data-level="1.4" data-path="intro-ngs-and-genetics-project.html"><a href="intro-ngs-and-genetics-project.html#data"><i class="fa fa-check"></i><b>1.4</b> Data</a></li>
<li class="chapter" data-level="1.5" data-path="intro-ngs-and-genetics-project.html"><a href="intro-ngs-and-genetics-project.html#analysis"><i class="fa fa-check"></i><b>1.5</b> Analysis</a></li>
<li class="chapter" data-level="1.6" data-path="intro-ngs-and-genetics-project.html"><a href="intro-ngs-and-genetics-project.html#literature"><i class="fa fa-check"></i><b>1.6</b> Literature</a></li>
<li class="chapter" data-level="1.7" data-path="intro-ngs-and-genetics-project.html"><a href="intro-ngs-and-genetics-project.html#reporting"><i class="fa fa-check"></i><b>1.7</b> Reporting</a></li>
<li class="chapter" data-level="1.8" data-path="intro-ngs-and-genetics-project.html"><a href="intro-ngs-and-genetics-project.html#assignments-week-1"><i class="fa fa-check"></i><b>1.8</b> Assignments Week 1</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="intro-ngs-and-genetics-project.html"><a href="intro-ngs-and-genetics-project.html#galaxy-server"><i class="fa fa-check"></i><b>1.8.1</b> Galaxy Server</a></li>
<li class="chapter" data-level="1.8.2" data-path="intro-ngs-and-genetics-project.html"><a href="intro-ngs-and-genetics-project.html#data-and-quality-control"><i class="fa fa-check"></i><b>1.8.2</b> Data and quality control</a></li>
<li class="chapter" data-level="1.8.3" data-path="intro-ngs-and-genetics-project.html"><a href="intro-ngs-and-genetics-project.html#fastq-format"><i class="fa fa-check"></i><b>1.8.3</b> FASTQ format</a></li>
<li class="chapter" data-level="1.8.4" data-path="intro-ngs-and-genetics-project.html"><a href="intro-ngs-and-genetics-project.html#quality-control"><i class="fa fa-check"></i><b>1.8.4</b> Quality Control</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="read-mapping.html"><a href="read-mapping.html"><i class="fa fa-check"></i><b>2</b> Read Mapping</a>
<ul>
<li class="chapter" data-level="2.1" data-path="read-mapping.html"><a href="read-mapping.html#mapping-with-bwa"><i class="fa fa-check"></i><b>2.1</b> Mapping with BWA</a></li>
<li class="chapter" data-level="2.2" data-path="read-mapping.html"><a href="read-mapping.html#assignment-week-2"><i class="fa fa-check"></i><b>2.2</b> Assignment week 2</a></li>
<li class="chapter" data-level="2.3" data-path="read-mapping.html"><a href="read-mapping.html#marking-duplicate-mapped-reads"><i class="fa fa-check"></i><b>2.3</b> Marking Duplicate Mapped Reads</a></li>
<li class="chapter" data-level="2.4" data-path="read-mapping.html"><a href="read-mapping.html#visualizing-the-mapping-data"><i class="fa fa-check"></i><b>2.4</b> Visualizing the Mapping Data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="analysis-of-variants.html"><a href="analysis-of-variants.html"><i class="fa fa-check"></i><b>3</b> Analysis of Variants</a>
<ul>
<li class="chapter" data-level="3.1" data-path="analysis-of-variants.html"><a href="analysis-of-variants.html#assignment-week-3"><i class="fa fa-check"></i><b>3.1</b> Assignment week 3</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="analysis-of-variants.html"><a href="analysis-of-variants.html#programming-assignments-coverage-overview-for-panel-genes"><i class="fa fa-check"></i><b>3.1.1</b> Programming Assignments; Coverage Overview for Panel Genes</a></li>
<li class="chapter" data-level="3.1.2" data-path="analysis-of-variants.html"><a href="analysis-of-variants.html#assignment-instructions"><i class="fa fa-check"></i><b>3.1.2</b> Assignment Instructions</a></li>
<li class="chapter" data-level="3.1.3" data-path="analysis-of-variants.html"><a href="analysis-of-variants.html#assignment-1-loading-the-bed-data"><i class="fa fa-check"></i><b>3.1.3</b> Assignment 1; Loading the BED-data</a></li>
<li class="chapter" data-level="3.1.4" data-path="analysis-of-variants.html"><a href="analysis-of-variants.html#assignment-2-bed-visualization"><i class="fa fa-check"></i><b>3.1.4</b> Assignment 2; BED-visualization</a></li>
<li class="chapter" data-level="3.1.5" data-path="analysis-of-variants.html"><a href="analysis-of-variants.html#assignment-3-bioconductor"><i class="fa fa-check"></i><b>3.1.5</b> Assignment 3; Bioconductor</a></li>
<li class="chapter" data-level="3.1.6" data-path="analysis-of-variants.html"><a href="analysis-of-variants.html#assignment-4-gene-lengths"><i class="fa fa-check"></i><b>3.1.6</b> Assignment 4; Gene Lengths</a></li>
<li class="chapter" data-level="3.1.7" data-path="analysis-of-variants.html"><a href="analysis-of-variants.html#assignment-5-loading-the-mapped-reads"><i class="fa fa-check"></i><b>3.1.7</b> Assignment 5; Loading the Mapped Reads</a></li>
<li class="chapter" data-level="3.1.8" data-path="analysis-of-variants.html"><a href="analysis-of-variants.html#rsamtools"><i class="fa fa-check"></i><b>3.1.8</b> Rsamtools</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="analysis-of-variants.html"><a href="analysis-of-variants.html#assignment-6-pileup-processing"><i class="fa fa-check"></i><b>3.2</b> Assignment 6; Pileup Processing</a></li>
<li class="chapter" data-level="3.3" data-path="analysis-of-variants.html"><a href="analysis-of-variants.html#assignment-7-coverage-calculation-and-reporting"><i class="fa fa-check"></i><b>3.3</b> Assignment 7; Coverage calculation and reporting</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="analysis-of-variants.html"><a href="analysis-of-variants.html#hints"><i class="fa fa-check"></i><b>3.3.1</b> Hints</a></li>
<li class="chapter" data-level="3.3.2" data-path="analysis-of-variants.html"><a href="analysis-of-variants.html#end-result"><i class="fa fa-check"></i><b>3.3.2</b> End Result</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="analysis-of-variants.html"><a href="analysis-of-variants.html#finding-variants-using-lofreq"><i class="fa fa-check"></i><b>3.4</b> Finding Variants using <code>LoFreq</code></a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="analysis-of-variants.html"><a href="analysis-of-variants.html#vcf-file-filtering"><i class="fa fa-check"></i><b>3.4.1</b> VCF File Filtering</a></li>
<li class="chapter" data-level="3.4.2" data-path="analysis-of-variants.html"><a href="analysis-of-variants.html#assignment-8-vcf-file-processing"><i class="fa fa-check"></i><b>3.4.2</b> Assignment 8; VCF File Processing</a></li>
<li class="chapter" data-level="3.4.3" data-path="analysis-of-variants.html"><a href="analysis-of-variants.html#assignment-9-variant-visualization"><i class="fa fa-check"></i><b>3.4.3</b> Assignment 9; Variant Visualization</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="variant-annotation.html"><a href="variant-annotation.html"><i class="fa fa-check"></i><b>4</b> Variant Annotation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="variant-annotation.html"><a href="variant-annotation.html#snpeff-and-snpsift"><i class="fa fa-check"></i><b>4.1</b> SnpEff and SnpSift</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="variant-annotation.html"><a href="variant-annotation.html#assignment"><i class="fa fa-check"></i><b>4.1.1</b> Assignment</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="variant-annotation.html"><a href="variant-annotation.html#programming-assignment-analyzing-variant-annotation"><i class="fa fa-check"></i><b>4.2</b> Programming Assignment; Analyzing Variant Annotation</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="variant-annotation.html"><a href="variant-annotation.html#assignment-10-data-preparation"><i class="fa fa-check"></i><b>4.2.1</b> Assignment 10; Data Preparation</a></li>
<li class="chapter" data-level="4.2.2" data-path="variant-annotation.html"><a href="variant-annotation.html#assignment-11-finding-variants-of-interest"><i class="fa fa-check"></i><b>4.2.2</b> Assignment 11; Finding Variants of Interest</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="variant-annotation.html"><a href="variant-annotation.html#galaxy-workflow"><i class="fa fa-check"></i><b>4.3</b> Galaxy Workflow</a></li>
<li class="chapter" data-level="4.4" data-path="variant-annotation.html"><a href="variant-annotation.html#comparative-genomics-optional"><i class="fa fa-check"></i><b>4.4</b> Comparative Genomics [Optional]</a></li>
<li class="chapter" data-level="4.5" data-path="variant-annotation.html"><a href="variant-annotation.html#poster"><i class="fa fa-check"></i><b>4.5</b> Poster</a></li>
<li class="chapter" data-level="4.6" data-path="variant-annotation.html"><a href="variant-annotation.html#galaxy-data-cleanup"><i class="fa fa-check"></i><b>4.6</b> Galaxy Data Cleanup</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Diagnostic Genome Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="variant-annotation" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Week 4</span> Variant Annotation<a href="variant-annotation.html#variant-annotation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In the - for now - final Galaxy workflow step for analyzing our patient, we are going to annotate all our filtered variants to determine the severity of the variations we determined last time with the <code>LoFreq</code> tool. This involves comparing all our variants against a number of databases containing <em>annotation data</em> for known variants. We will use our filtered <code>VCF</code>-file resulting from LoFreq so we need to upload our newly created VCF file to Galaxy. Make sure that Galaxy recognizes the file type by selecting the correct file type when uploading or change it afterwards using the <em>Edit attributes</em> button.</p>
<p><img src="images/upload.png" width="432" /></p>
<div id="snpeff-and-snpsift" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> SnpEff and SnpSift<a href="variant-annotation.html#snpeff-and-snpsift" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are multiple methods of annotating found variants. Most of these will require extra data to predict the effect of a variant or to compare it with a known set of variants. Here we use a set of tools that does both types of annotation. See for further details and a manual the <a href="http://pcingola.github.io/SnpEff/">Github documentation</a>.</p>
<ul>
<li><strong><code>SnpEff</code></strong>: <em>is a variant annotation and effect prediction tool. It annotates and predicts the effects of genetic variants (such as amino acid changes)</em></li>
<li><strong><code>SnpSift</code></strong>: <em>is a toolbox that allows you to filter and manipulate annotated files.</em>
<ul>
<li>actually, this tool also annotates variants using a variety of data sources, for which we will use it.</li>
</ul></li>
</ul>
<p>Both tools are available in Galaxy with numerous sub-tools depending on the task that you want to do. To get the most information for each variant, we will perform three annotation <em>runs</em>:</p>
<p><strong>Step 1</strong>: Using SnpEff to annotate variants using the <code>GRCh38.86</code> database adding information related to the gene, transcript and protein that are affected by this variant. This results in a lot of extra data that is all documented in the changed VCF header.</p>
<p>For example, given the following variant as input:</p>
<blockquote>
<p><code>chr1 237550644   .   C   A   91.0    PASS    DP=578;AF=0.017301;SB=1;DP4=252,316,5,5</code></p>
</blockquote>
<p>This is the result after SnpEff:</p>
<blockquote>
<p><code>chr1 237550644   .   C   A   91.0    PASS    DP=578;AF=0.017301;SB=1;DP4=252,316,5,5;ANN=A|missense_variant|MODERATE|RYR2|ENSG00000198626|transcript|ENST00000366574.6|protein_coding|27/105|c.3167C&gt;A|p.Thr1056Lys|3484/16562|3167/14904|1056/4967||,A|missense_variant|MODERATE|RYR2|ENSG00000198626|transcript|ENST00000360064.7|protein_coding|25/103|c.3119C&gt;A|p.Thr1040Lys|3119/14850|3119/14850|1040/4949||WARNING_TRANSCRIPT_NO_START_CODON,A|downstream_gene_variant|MODIFIER|SNORA25|ENSG00000252290|transcript|ENST00000516481.1|snoRNA||n.*4396G&gt;T|||||4396|</code></p>
</blockquote>
<p>All details are added in the <code>ANN</code> field. See the description in the VCF header for a field-by-field explanation of the values.</p>
<p><strong>Running SnpEff</strong>:</p>
<ul>
<li>Select the <code>SnpEff Variant effect and annotation</code> tool from the <code>Variant Calling</code> tool menu in Galaxy.</li>
<li>Select the uploaded VCF file containing the variants filtered for the cardiopanel genes.</li>
<li>Check if the by default selected <code>GRCh38.86</code> <em>Genome Source</em> is selected.</li>
<li>All other settings can be left default, execute the tool.</li>
</ul>
<p>The result consists of two files: an annotated VCF file and a web-report on all the variants and their predicted effects.</p>
<p><strong>Step 2</strong>: Adding <code>dbSnp</code> entries using <code>SnpSift</code>. The <a href="https://www.ncbi.nlm.nih.gov/snp/">dbSnp</a> database contains information on known variants. The version that also includes clinical significance (combining the ClinVar database) is available for the SnpSift tool in Galaxy.</p>
<p><strong>Running SnpSift for dbsnp</strong>:</p>
<ul>
<li>SnpSift requires the <code>dbSnp</code> database to be available in your history:
<ul>
<li>In Galaxy, go to <code>Shared Data</code> (top menu) –&gt; <code>Data Libraries</code> –&gt; <code>dbSnp</code> library</li>
<li>Select both files shown there and use the <code>Add to history</code> –&gt; <code>as datasets</code> option to get them in your own history</li>
</ul></li>
<li>Select the <code>SnpSift Annotate SNPs from dbSnp</code> tool from the <code>Variant Calling</code> tool menu in Galaxy.
<ul>
<li><strong>Note</strong>: this is a different tool from the <code>dbNSFP</code> database, see step #3 below.</li>
</ul></li>
<li>Select the output VCF file created by SnpEff in step #1 as the <code>Variant input file</code>.</li>
<li>Select the <code>dbSnp_clinvar.vcf.gz</code> file as the <code>VCF File with ID field annotated</code>.</li>
<li>For <code>Fields to annotate</code> select the <code>Add also INFO fields</code> option and execute the tool.</li>
</ul>
<p>This tool adds annotations in two columns. First, the <code>ID</code> column will describe the <code>dbSnp</code> ID (rs number) that can be used to look up the variant. Second, the <code>INFO</code> column is expanded with (a lot of) extra information if the variant is known. For instance, the ClinVar data might report on diseases the variant is related to, such as:</p>
<blockquote>
<p><code>CLNDN=Cardiovascular_phenotype|Charcot-Marie-Tooth_disease|Lipoatrophy_with_Diabetes,_Hepatic_Steatosis,_Hypertrophic_Cardiomyopathy,_and_Leukomelanodermic_Papules</code></p>
</blockquote>
<p><strong>Step 3</strong>: Annotating using the <code>dbNSFP</code> database and SnpSift. The dbNSFP database is a huge collection (over 300GB of text files) of annotation sources combined into a single database. The SnpSift tool can compare our variants with known variants from all of these annotation sources and - like the first few steps - adds them to our VCF file. As you can expect, our VCF file will become very large and most likely unreadable. Therefore, we re-use the VCF file gained from step #1 instead of the VCF file from SnpSift in step #2. We can later combine the data after parsing both files separately.</p>
<p><strong>Running SnpSift for dbNSFP</strong>:</p>
<ul>
<li>Select the <code>SnpSift dbNSFP</code> tool from the <code>Variant Calling</code> tool menu in Galaxy.</li>
<li>Use the VCF file from step #1 as input</li>
<li>Select the locally available <code>GRCh38 dbNSFP4.3c</code> Genome database</li>
<li>Select all options for the <code>Annotate with</code> option</li>
</ul>
<p>Note that the tool description lists output not available for selection, we will look into the specifics of all selected databases later on.</p>
<!--

Commandline SnpEff and SnpSift for 2.1.2

Step #1 SnpEff

cd /local-fs/datasets/dbNSFP/snpEff/;
java -jar snpEff.jar ann GRCh38.105 /homes/marcelk/Development/NGS-Genetics/solution/bed_variants.vcf > /homes/marcelk/Development/NGS-Genetics/solution/bed_annotation.vcf
----------

Step #2 SnpSift - dbSnp

/local-fs/datasets/dbNSFP/snpEff/scripts/snpSift annotate /local-fs/datasets/dbNSFP/snpEff/data/clinvar.vcf.gz /homes/marcelk/Development/NGS-Genetics/solution/bed_variants.vcf > /homes/marcelk/Development/NGS-Genetics/solution/bed_annotation.vcf
----------

Step #3 SnpSift - dbNSFP with all options:

/local-fs/datasets/dbNSFP/snpEff/scripts/snpSift DbNsfp -db /data/datasets/dbNSFP/snpEff/data/dbNSFP4.3c.txt.gz /homes/marcelk/Development/NGS-Genetics/solution/bed_variants.vcf > /homes/marcelk/Development/NGS-Genetics/solution/bed_annotation.vcf
----------

-->
<div id="assignment" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Assignment<a href="variant-annotation.html#assignment" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Create a table in your report where you summarize the added annotation data (very!) briefly;
<ul>
<li>The database where the data comes from</li>
<li>The result or value (is it an identifier, a percentage, etc.).</li>
<li><strong>Hint</strong>: you can add formatted tables in markdown with some syntax which is easiest generated at <a href="www.tablesgenerator.com/markdown_tables">https://www.tablesgenerator.com</a></li>
</ul></li>
</ul>
<p>The VCF header only describes the names of the databases the data originates from and does not give a clear explanation. There might be a single source for the documentation (please let us know if you find it!), but for now the best method of getting information about the added data is:</p>
<ul>
<li><strong>Step #1</strong>: the output of the first step also includes a web report that at least gives more details on the results. Either use your biological knowledge or search for terms if they’re unclear</li>
<li><strong>Step #2</strong>: data from the <code>dbSnp</code> database comes from the ‘ClinVar’ version of this database, which is documented <a href="https://www.ncbi.nlm.nih.gov/variation/docs/ClinVar_vcf_files/">on its NCBI website</a>.</li>
<li><strong>Step #3</strong>: for the <code>dbNSFP</code> database there are descriptions available on the online version:
<ul>
<li>Go to <a href="http://database.liulab.science/dbNSFP">the online dbNSFP instance</a>, select the <strong>Academic</strong> option and click <strong>Connect</strong>.</li>
<li>If you hover over any of the selectable Variant fields, you can read a brief description of the data that is added.</li>
<li>Note that this is for dbNSFP version 4.4a and we use version 4.3c (very minor differences)</li>
</ul></li>
</ul>
</div>
</div>
<div id="programming-assignment-analyzing-variant-annotation" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Programming Assignment; Analyzing Variant Annotation<a href="variant-annotation.html#programming-assignment-analyzing-variant-annotation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Given the possibly hundreds of annotated variants with data from multiple data sources, it’s time to do one last <em>filtering</em> on the data to come up with a list of variants of which we can say, with some certainty, that they are related to the condition. As with the VCF-filter tool that we’ve written, here too will we check each line and decide if it is a variant worth reporting on. Whether we want to keep a variant or not depends on the annotation added by SnpEff/SnpSift and it is your task to come up with an approach for <strong>combining</strong> data from these data sources to <em>rank</em> the annotated variants.</p>
<div id="assignment-10-data-preparation" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Assignment 10; Data Preparation<a href="variant-annotation.html#assignment-10-data-preparation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This programming assignment asks to take another good look at the data, but now in R to see if everything is in a suitable format to eventually sort the data and extract a top-set of variants related to the condition. As you have seen, all data is essentially stored in a single column that contains multiple separators (such as <code>|</code> and <code>;</code>). You need to think of and implement a good strategy to convert all this information into a workable data format, such as a data frame.</p>
<p>There are a few caveats though that can also be seen when looking at the SnpEff report (the ‘stats’ output). For instance, there are two lines in the overview table that describe the amount of variants and the amount of hits in the SnpEff database:</p>
<ul>
<li><code>Number of variants (before filter)       145</code></li>
<li><code>Number of effects        1,332</code></li>
</ul>
<p>Which means that on average every variant has about 10 (!) hits of which all data is placed in the <code>INFO</code> column (most notably in the <code>ANN</code> part of the <code>INFO</code> column). This is caused most often by multiple transcripts (alternative splicing) being affected by this variant. This makes it very difficult to parse and therefore this section gives tips and example code to assist in that task. With this much data from three different steps it is too complex to assess in a single run so we will assess annotation data step by step.</p>
<div id="step-1-2-snpeff-ann-data-and-snpsift-clinvar-data" class="section level4 hasAnchor" number="4.2.1.1">
<h4><span class="header-section-number">4.2.1.1</span> Step #1 &amp; #2; SnpEff ANN data and SnpSift ClinVar data<a href="variant-annotation.html#step-1-2-snpeff-ann-data-and-snpsift-clinvar-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>According to the VCF header, the <code>ANN</code> data contains the values explained in the <a href="https://pcingola.github.io/SnpEff/se_inputoutput/#ann-field-vcf-output-files">SnpEff documentation</a>. Some, or all of them could be of interest. There is a Galaxy tool available to extract interesting fields from the added data.</p>
<ul>
<li>Select the <code>SnpSift Extract Fields from a VCF file into a tabular file</code> tool from the tool menu
<ul>
<li>the tool help or <a href="https://pcingola.github.io/SnpEff/snpsift/extractfields/">this manual</a> can provide more details</li>
</ul></li>
<li>Select the annotated VCF file as input</li>
<li>Provide the names of the columns of interest. For instance, the following could be used as a query for the ‘Fields to extract’:
<ul>
<li><code>CHROM POS REF ALT ANN[*].EFFECT ANN[*].IMPACT ANN[*].GENE ANN[*].FEATURE ANN[*].FEATUREID ANN[*].BIOTYPE ANN[*].ERRORS CLNDN CLNSIG</code></li>
<li>Add or remove any other column you find interesting to the above query.</li>
</ul></li>
<li>Enable the ‘One effect per line’ option</li>
<li>Run the tool and download the resulting tabular file for analysis in R
<ul>
<li>The resulting file contains as many rows as effects reported by SnpEff (1332 in this example)</li>
</ul></li>
</ul>
<div class="rmdnote">
<p>Note: always include the <code>CHROM POS REF ALT</code> columns which are needed to identify the variant in the original file.</p>
</div>
</div>
<div id="step-3-snpsift-dbnsfp" class="section level4 hasAnchor" number="4.2.1.2">
<h4><span class="header-section-number">4.2.1.2</span> Step #3; SnpSift dbNSFP<a href="variant-annotation.html#step-3-snpsift-dbnsfp" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Similar to the previous step, extract the fields of interest using the <code>SnpSift Extract Fields from a VCF file into a tabular file</code> tool. The <code>dbNSFP</code> entries are all prefixed with <code>dbNSFP_</code>, for instance: <code>dbNSFP_MutationAssessor_score</code> and <code>dbNSFP_SIFT_pred</code>. Once done, download this tabular file too for further analysis.</p>
</div>
</div>
<div id="assignment-11-finding-variants-of-interest" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Assignment 11; Finding Variants of Interest<a href="variant-annotation.html#assignment-11-finding-variants-of-interest" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Given the knowledge we have on the data stored in the two dataframes, we can now formulate questions for this data to find a set of variants which are most likely linked to the cardiomyopathy condition. This condition cannot be identified by a single variant but is often caused by several variants and the combination not only determines <em>if</em> someone suffers from cardiomyopathy but also how <em>badly</em> their condition is.</p>
<p>The physician who diagnoses patients uses the genetic information of the found variants as one of the sources for confirming the condition. However, presenting a list of 100+ variant positions with a list of numbers from some tools is not how that works in practice; we need to present a short, ordered list of variants that can be related to the condition.</p>
<p>Next, define your own sorting, filtering, selecting, etc. procedure to filter and order a top-list of variants that you’d present as aid to a diagnoses. For instance, you might have a variant that had a hit in the ClinVar database which directly links it to cardiomyopathy, this should probably be somewhere around the top of your list. Again, look at the output description that you’ve written earlier to come up with combination(s) of values. There is no golden standard for selecting these variants so it is very important to properly document and argument your decisions.</p>
<p>As an end product for this step you are expected to include a nice table including at least 10 variants in your report that contains all relevant information for each of them, i.e. the chromomsome, position, reference and variant nucleotides, gene name and all relevant scores.</p>
<p>For all of your variants, try to (briefly!) answer the following questions for each variant:</p>
<ul>
<li>Can you find a link between cardiomyopathy and the variant?</li>
<li>What is the effect of the variant?</li>
<li>Is it validated?</li>
<li>Are there scientific studies supporting the evidence?</li>
<li>What does the score indicate?</li>
<li>What else can you find about the variant?</li>
</ul>
<p>You can use the following online sources among others:</p>
<ul>
<li><a href="http://www.ncbi.nlm.nih.gov/snp/" class="uri">http://www.ncbi.nlm.nih.gov/snp/</a></li>
<li><a href="http://www.ncbi.nlm.nih.gov/variation/tools/1000genomes/" class="uri">http://www.ncbi.nlm.nih.gov/variation/tools/1000genomes/</a></li>
<li><a href="http://www.ncbi.nlm.nih.gov/projects/SNP/" class="uri">http://www.ncbi.nlm.nih.gov/projects/SNP/</a></li>
</ul>
</div>
</div>
<div id="galaxy-workflow" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Galaxy Workflow<a href="variant-annotation.html#galaxy-workflow" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now that we have completed our analysis steps we can create a <strong>Galaxy workflow</strong>. In this workflow we will combine all the tools that we have used in Galaxy (FastQ files –&gt; SnpEff/SnpSift annotated output) so that when we receive new patient data in the future we can analyze that dataset with a single click!</p>
<p>There are many <a href="https://galaxyproject.org/learn/advanced-workflow/">online resources</a> giving instructions and examples for creating Galaxy workflows, use these resources to create a workflow including all used analysis tools. Note that you can convert Galaxy histories into workflow(s), which saves a lot of time with configuring all the tools from that workfow.</p>
<p>Once you have a workflow, make sure it is shared with your project partner and create a screenshot of it for your report (try to fit all tools in a single image).</p>
<p><strong>Note</strong>; this assignment has a very low priority and should be done once you are satisfied with all other parts of your work! At the bare minimum, open your last history (including SnpEff/SnpSift) and explore/ play with the <code>Extract Workflow</code> option.</p>
</div>
<div id="comparative-genomics-optional" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Comparative Genomics [Optional]<a href="variant-annotation.html#comparative-genomics-optional" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>With the complete analysis nicely packaged into a single workflow, one thing that we can use it for is to do <em>comparative genomics</em>. This term contains many different types of comparisons and is described on Wikipedia as</p>
<blockquote>
<p><em>Comparative genomics is a field of biological research in which the genomic features of different organisms are compared.</em></p>
</blockquote>
<p>These features can be of many types and in our case they are the variants. A simple tool is available in Galaxy called <em>VCF-VCFintersect</em> that performs either <em>intersection</em> or <em>union</em> on two VCF datasets containing variant data. This tool compares two VCF files and retains either the shared variants (intersection) or all variants combined (union) as shown in the diagram below.</p>
<p><img src="images/intersect_union.png" width="310" /></p>
<p><strong>Assignment</strong></p>
<ul>
<li>Process another sample (use a new history) by running your complete workflow.
<ul>
<li>Note that you have to filter the resulting SnpEff output (which contains the same data as the VCF file appended with annotation data) with the BED-data. Alternatively, you can stop after the LoFreq tool, download the VCF file, filter this using the BED-data and re-upload the filtered VCF file before continuing with SnpEff</li>
</ul></li>
<li>Calculate the following three statistics:
<ul>
<li>The number of variants unique to patient 1</li>
<li>The number of variants unique to patient 2</li>
<li>The number of variants found in both patients</li>
</ul></li>
<li>Create a VENN-diagram (like the image above) displaying these numbers.</li>
</ul>
</div>
<div id="poster" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Poster<a href="variant-annotation.html#poster" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The final assignment is to create a poster that summarizes your work and will be presented at the institute poster day scheduled in the final exam week. The poster should contain the following elements:</p>
<ul>
<li><strong>Title</strong>: A title that summarizes the main message of your poster.</li>
<li><strong>Abstract</strong>: A short summary of your work. Contains a brief introduction of the topic (condition), the data used, the methods applied, the results obtained, and the conclusions drawn.</li>
<li><strong>Materials and Methods</strong>: A brief description of the methods used in your analysis. Most likely a combination of a description of the data source (sequencer, how many patients, how many reads) and a visual representation of the workflow. This can either be a screenshot from Galaxy or a flow-chart in which you describe the tools used/ steps taken.</li>
<li><strong>Results</strong>: A summary of the results of your analysis, with for instance:
<ul>
<li><em>Table</em>: A table with the top (10-15) variants that you found.</li>
<li><em>Figure</em>: A visualization of the variants, for instance using a <em>lollipopplot</em> as shown below, a screenshot from IGV showing the variant</li>
</ul></li>
<li><strong>Conclusion/ Discussion</strong>: A discussion of the results and their implications.</li>
<li><strong>Contact Information</strong>: name(s) and email address(es) and affiliation (<em>Hanze University of Applied Sciences, minor …</em>).</li>
</ul>
<p>The poster should be designed to be visually appealing and easy to read. You can use any software you like to create the poster, but we recommend using PowerPoint (online) or Open Office Draw on our Linux systems.</p>
<p><strong>LollipopPlot</strong></p>
<p>This visualization can be helpful in cases where many of the top-variants are located within a single gene. The plot shows the position of the variant on the x-axis and a score on the y-axis. The score can be the <em>AF</em> value from the VCF file or any other score that was added through the annotation steps. Further data (‘dimensions’) can be added through for instance:
* The color of the lollipop (e.g. red for a high score, green for a low score)
* The size of the lollipop (e.g. the size of the lollipop is proportional to the score)
* The symbol of the lollipop (e.g. a star for a variant that is validated)
* A value displayed within each node
* Text labels attached to the nodes</p>
<p>There are multiple options for drawing these types of graphs but here we demonstrate the use of the <code>lolliplot</code> function from the <code>trackViewer</code> package in R, see the <a href="https://bioconductor.org/packages/release/bioc/vignettes/trackViewer/inst/doc/lollipopPlot.html">online manual</a> for many examples on how to create this plot. This package is not installed by default in, so you have to install it yourself:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="variant-annotation.html#cb36-1" tabindex="-1"></a>BiocManager<span class="sc">::</span><span class="fu">install</span>(<span class="st">&quot;trackViewer&quot;</span>)</span>
<span id="cb36-2"><a href="variant-annotation.html#cb36-2" tabindex="-1"></a><span class="fu">library</span>(trackViewer)</span></code></pre></div>
<p>It requires two data sources for our use case:
* The <em>sample</em> data which should be a GRanges object containing the <strong>variants</strong>
* The <em>feature</em> data containing the <strong>gene</strong> on which these variants are located</p>
<p>This basic example shows 9 variants for the RET gene, with the <em>AF</em> value as the score (scaled to a range of 0-100%). The plot shows the position of the variant on the x-axis and the allele-frequency on the y-axis.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="variant-annotation.html#cb37-1" tabindex="-1"></a><span class="co"># Calculate AF as percentage and set as &#39;score&#39; field</span></span>
<span id="cb37-2"><a href="variant-annotation.html#cb37-2" tabindex="-1"></a>sample.gr<span class="sc">$</span>score <span class="ot">&lt;-</span> sample.gr<span class="sc">$</span>AF <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb37-3"><a href="variant-annotation.html#cb37-3" tabindex="-1"></a><span class="fu">head</span>(sample.gr)</span></code></pre></div>
<pre><code>## GRanges object with 6 ranges and 2 metadata columns:
##       seqnames    ranges strand |     score        AF
##          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;numeric&gt; &lt;numeric&gt;
##   [1]    chr10  43077059      * |   92.8571  0.928571
##   [2]    chr10  43077063      * |   60.0000  0.600000
##   [3]    chr10  43100520      * |   99.8780  0.998780
##   [4]    chr10  43111239      * |  100.0000  1.000000
##   [5]    chr10  43118395      * |   44.8733  0.448733
##   [6]    chr10  43119646      * |   45.9846  0.459846
##   -------
##   seqinfo: 21 sequences from an unspecified genome; no seqlengths</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="variant-annotation.html#cb39-1" tabindex="-1"></a><span class="co"># RET gene exons</span></span>
<span id="cb39-2"><a href="variant-annotation.html#cb39-2" tabindex="-1"></a><span class="fu">head</span>(features)</span></code></pre></div>
<pre><code>## GRanges object with 6 ranges and 0 metadata columns:
##       seqnames            ranges strand
##          &lt;Rle&gt;         &lt;IRanges&gt;  &lt;Rle&gt;
##   RET    chr10 43077026-43077331      *
##   RET    chr10 43100458-43100722      *
##   RET    chr10 43102341-43102629      *
##   RET    chr10 43104731-43105193      *
##   RET    chr10 43106375-43106571      *
##   RET    chr10 43109030-43109230      *
##   -------
##   seqinfo: 22 sequences from an unspecified genome; no seqlengths</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="variant-annotation.html#cb41-1" tabindex="-1"></a><span class="fu">lolliplot</span>(sample.gr, features, <span class="at">ylab =</span> <span class="st">&quot;Allele Frequency (%)&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<p>Simple improvements are to increase the heigth and color of the exons (all exons share the same value):</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="variant-annotation.html#cb42-1" tabindex="-1"></a>features<span class="sc">$</span>height <span class="ot">&lt;-</span> <span class="fl">0.03</span></span>
<span id="cb42-2"><a href="variant-annotation.html#cb42-2" tabindex="-1"></a>features<span class="sc">$</span>fill <span class="ot">&lt;-</span> <span class="st">&quot;lightblue&quot;</span></span>
<span id="cb42-3"><a href="variant-annotation.html#cb42-3" tabindex="-1"></a><span class="fu">head</span>(features)</span></code></pre></div>
<pre><code>## GRanges object with 6 ranges and 2 metadata columns:
##       seqnames            ranges strand |    height        fill
##          &lt;Rle&gt;         &lt;IRanges&gt;  &lt;Rle&gt; | &lt;numeric&gt; &lt;character&gt;
##   RET    chr10 43077026-43077331      * |      0.03   lightblue
##   RET    chr10 43100458-43100722      * |      0.03   lightblue
##   RET    chr10 43102341-43102629      * |      0.03   lightblue
##   RET    chr10 43104731-43105193      * |      0.03   lightblue
##   RET    chr10 43106375-43106571      * |      0.03   lightblue
##   RET    chr10 43109030-43109230      * |      0.03   lightblue
##   -------
##   seqinfo: 22 sequences from an unspecified genome; no seqlengths</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="variant-annotation.html#cb44-1" tabindex="-1"></a><span class="fu">lolliplot</span>(sample.gr, features, <span class="at">ylab =</span> <span class="st">&quot;Allele Frequency (%)&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<p>Adding labels to the variants, in this case some random dbsnp IDs but these could be any other value available:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="variant-annotation.html#cb45-1" tabindex="-1"></a><span class="co"># Generate random dbsnp IDs</span></span>
<span id="cb45-2"><a href="variant-annotation.html#cb45-2" tabindex="-1"></a>dbsnp_ids <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;rs&quot;</span>, <span class="fu">sample</span>(<span class="dv">239283</span><span class="sc">:</span><span class="dv">532801</span>, <span class="fu">length</span>(sample.gr)))</span>
<span id="cb45-3"><a href="variant-annotation.html#cb45-3" tabindex="-1"></a></span>
<span id="cb45-4"><a href="variant-annotation.html#cb45-4" tabindex="-1"></a><span class="co"># Add names to the IRanges object within the GRanges</span></span>
<span id="cb45-5"><a href="variant-annotation.html#cb45-5" tabindex="-1"></a>sample.gr <span class="ot">&lt;-</span> <span class="fu">setNames</span>(sample.gr, dbsnp_ids)</span>
<span id="cb45-6"><a href="variant-annotation.html#cb45-6" tabindex="-1"></a></span>
<span id="cb45-7"><a href="variant-annotation.html#cb45-7" tabindex="-1"></a><span class="fu">lolliplot</span>(sample.gr, features, <span class="at">ylab =</span> <span class="st">&quot;Allele Frequency (%)&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-43-1.png" width="672" />
Changing the color based on the <em>effect impact</em> from the <code>SnpEff</code> Galaxy tool</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="variant-annotation.html#cb46-1" tabindex="-1"></a>effect <span class="ot">&lt;-</span>       <span class="fu">c</span>(<span class="st">&quot;MODERATE&quot;</span>, <span class="st">&quot;LOW&quot;</span>, <span class="st">&quot;MODIFIER&quot;</span>, <span class="st">&quot;HIGH&quot;</span>)</span>
<span id="cb46-2"><a href="variant-annotation.html#cb46-2" tabindex="-1"></a>effect.color <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;orange&quot;</span>,   <span class="st">&quot;blue&quot;</span>,<span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb46-3"><a href="variant-annotation.html#cb46-3" tabindex="-1"></a></span>
<span id="cb46-4"><a href="variant-annotation.html#cb46-4" tabindex="-1"></a><span class="co"># Randomly select an effect for each variant</span></span>
<span id="cb46-5"><a href="variant-annotation.html#cb46-5" tabindex="-1"></a>sample.gr<span class="sc">$</span>effect <span class="ot">&lt;-</span> effect[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="fu">length</span>(sample.gr), <span class="at">replace =</span> <span class="cn">TRUE</span>)]</span>
<span id="cb46-6"><a href="variant-annotation.html#cb46-6" tabindex="-1"></a></span>
<span id="cb46-7"><a href="variant-annotation.html#cb46-7" tabindex="-1"></a><span class="co"># Given the effect, get the matching color</span></span>
<span id="cb46-8"><a href="variant-annotation.html#cb46-8" tabindex="-1"></a>sample.gr<span class="sc">$</span>color <span class="ot">&lt;-</span> effect.color[<span class="fu">match</span>(sample.gr<span class="sc">$</span>effect, effect)]</span>
<span id="cb46-9"><a href="variant-annotation.html#cb46-9" tabindex="-1"></a></span>
<span id="cb46-10"><a href="variant-annotation.html#cb46-10" tabindex="-1"></a><span class="fu">lolliplot</span>(sample.gr, features, <span class="at">ylab =</span> <span class="st">&quot;Allele Frequency (%)&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<p>If there are a lot of variants close together, an alternative can be the <em>dandelion plot</em> which is a variation of the lollipop plot where the variants are grouped together based on their position. It’s available from the same library, see the <a href="https://bioconductor.org/packages/release/bioc/vignettes/trackViewer/inst/doc/trackViewer.html#Dandelion_Plot">online manual</a> for more information.</p>
</div>
<div id="galaxy-data-cleanup" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Galaxy Data Cleanup<a href="variant-annotation.html#galaxy-data-cleanup" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As a final closing task we ask you to clean up the Galaxy histories to save some space because it is difficult for the admin(s) to perform this cleaning for you. Once all products are finished, please consider removing all large files from your history, such as the outputs of the trimming (Trimmomatic), mapping (BWA), duplicate read marking (MarkDuplicates) and the pileup steps (Mpileup). For the large files, please make sure that you <em>also</em> click the <em>Permanently remove it from disk</em> link.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="analysis-of-variants.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
